{% extends 'blog/base.html' %}

{% block content %}
<div class="search-container">
    <div class="search-header">
        <h2>{% if query %}Search Results{% else %}Search Posts{% endif %}</h2>
        {% if query %}
            <p class="search-info">
                Found <strong>{{ post_count }}</strong> post{{ post_count|pluralize }} matching "<strong>{{ query }}</strong>"
            </p>
        {% endif %}
    </div>

    <!-- Search Form -->
    <div class="search-form-container">
        <form method="GET" action="{% url 'search' %}" class="search-form">
            <div class="search-input-group">
                <input 
                    type="text" 
                    name="q" 
                    value="{{ query }}" 
                    placeholder="Search posts by title, content, or tags..."
                    class="search-input"
                    required
                >
                <button type="submit" class="btn btn-primary search-btn">
                    <span class="search-icon">üîç</span> Search
                </button>
            </div>
        </form>
    </div>

    <!-- Search Results -->
    {% if query %}
        {% if posts %}
            <div class="search-results">
                {% for post in posts %}
                    <div class="post-item">
                        <div class="post-header">
                            <h3><a href="{% url 'post-detail' post.pk %}">{{ post.title }}</a></h3>
                            <div class="post-meta">
                                <span class="author">
                                    <span class="icon-user"></span>
                                    By {{ post.author.username }}
                                </span>
                                <span class="date">
                                    <span class="icon-calendar"></span>
                                    {{ post.published_date|date:"F d, Y" }}
                                </span>
                            </div>
                        </div>
                        
                        <div class="post-excerpt">
                            {{ post.content|truncatewords:50 }}
                        </div>

                        <!-- Tags -->
                        {% if post.tags.all %}
                            <div class="post-tags">
                                <span class="tags-label">Tags:</span>
                                {% for tag in post.tags.all %}
                                    <a href="{% url 'posts-by-tag' tag.name %}" class="tag-badge">
                                        #{{ tag.name }}
                                    </a>
                                {% endfor %}
                            </div>
                        {% endif %}

                        <a href="{% url 'post-detail' post.pk %}" class="read-more">Read More ‚Üí</a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-results">
                <div class="no-results-icon">üîç</div>
                <h3>No posts found</h3>
                <p>Sorry, we couldn't find any posts matching "{{ query }}".</p>
                <p>Try searching with different keywords or <a href="{% url 'posts' %}">browse all posts</a>.</p>
            </div>
        {% endif %}
    {% else %}
        <div class="search-tips">
            <h3>Search Tips</h3>
            <ul>
                <li>Enter keywords to search in post titles and content</li>
                <li>Search for specific tags to find related posts</li>
                <li>Use multiple keywords for more specific results</li>
                <li>Browse <a href="{% url 'tags-list' %}">all tags</a> to discover topics</li>
            </ul>
        </div>
    {% endif %}
</div>
{% endblock %}
